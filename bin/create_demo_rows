#!/usr/bin/env coffee

_ = require 'underscore'
Q = require 'q'
_(global).extend require('../lib/models')
sitters = require '../data/sitters.json'

createSittersP = Q.all sitters.map (sitter) ->
  id = sitter.id
  data = _.extend {}, sitter
  delete data.id

  console.info 'Updating', id, sitter.name
  Sitter.findOrCreate({id}, {data}).then (sitter) ->
    sitter.data = data
    sitter.save()

createSittersP
  .catch( (error) -> console.error error )
  .done ->
    process.exit()
